<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Starborn Transmission</title>
<style>
  body, html {
    margin: 0; padding: 0; width: 100%; height: 100%;
    overflow: hidden; background-color: #000;
    font-family: "Courier New", Courier, monospace, "Microsoft JhengHei";
    user-select: none; -webkit-tap-highlight-color: transparent;
  }
  canvas { display: block; }

  /* æƒæç·šæ¿¾é¡æ„Ÿ */
  body::after {
    content: " "; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
    background-size: 100% 4px; pointer-events: none; z-index: 500;
  }

  /* å•Ÿå‹•ä»‹é¢ */
  #boot-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000; z-index: 2000; display: flex; flex-direction: column;
    align-items: center; justify-content: center; color: #00ff41;
    transition: opacity 0.8s ease;
  }
  
  /* çµæŸä»‹é¢ */
  #end-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000; z-index: 2000; display: none; flex-direction: column;
    align-items: center; justify-content: center; color: #00ff41;
    opacity: 0; transition: opacity 2s ease;
  }

  .term-line { font-size: 14px; margin: 5px; letter-spacing: 2px; text-align: center; }
  
  #countdown-timer {
    font-size: 24px; color: #ff3333; margin: 20px 0;
    text-shadow: 0 0 10px #ff3333; font-weight: bold;
  }

  #start-btn {
    margin-top: 20px; padding: 15px 40px; border: 1px solid #444;
    background: rgba(255, 255, 255, 0.05); color: #444; cursor: not-allowed;
    font-family: inherit; font-weight: bold; letter-spacing: 4px;
    transition: all 0.5s;
  }

  /* è§£é–å¾Œçš„æŒ‰éˆ•æ¨£å¼ */
  #start-btn.unlocked {
    border-color: #00ff41; color: #00ff41; cursor: pointer;
    box-shadow: 0 0 15px rgba(0, 255, 65, 0.2);
    background: rgba(0, 255, 65, 0.1);
  }

  /* æˆ°è¡“ HUD */
  #hud {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 100; display: none; color: #00ff41;
  }
  .reticle { position: absolute; border: 1px solid rgba(0, 255, 65, 0.3); width: 50px; height: 50px; }
  .tl { top: 20px; left: 20px; border-right: none; border-bottom: none; }
  .tr { top: 20px; right: 20px; border-left: none; border-bottom: none; }
  .bl { bottom: 20px; left: 20px; border-right: none; border-top: none; }
  .br { bottom: 20px; right: 20px; border-left: none; border-top: none; }
  
  #data-stream { position: absolute; top: 40px; left: 80px; font-size: 10px; line-height: 1.8; }
  #charge-ui {
    position: absolute; bottom: 100px; left: 50%; transform: translateX(-50%);
    width: 200px; height: 4px; border: 1px solid #00ff41; display: none;
  }
  #charge-bar { width: 0%; height: 100%; background: #00ff41; }
  /* ---------------------------------------------------------
   ğŸ“± æ‰‹æ©Ÿæœ€ä½³åŒ– â€” ç§»é™¤æ¿¾é¡ + æé«˜ç•«é¢æ¸…æ™°åº¦
--------------------------------------------------------- */
  @media (max-width: 768px) {

  /* å®Œå…¨ç§»é™¤æƒæç·šæ¿¾é¡ */
  body::after {
    content: none !important;
    background: none !important;
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
  }

  /* æ‰‹æ©Ÿå°è¢å¹•å­—é«”æ›´æ¸…æ¥š */
  .term-line { font-size: 12px; letter-spacing: 1px; }

  #countdown-timer { font-size: 20px; }

  /* HUD å…ƒç´ ç¸®å°é¿å…é®æ“‹ */
  .reticle { width: 35px; height: 35px; }
  #data-stream { left: 20px; top: 20px; font-size: 9px; }

  /* å‹•ç•«å…‰é»é¿å…å¤ªäº® */
  canvas {
    image-rendering: crisp-edges;
  }
}
</style>
</head>
<body>

<!-- å•Ÿå‹•ä»‹é¢ -->
<div id="boot-screen">
  <div class="term-line">UPLINKING TO MASTER_CHEN_TERMINAL...</div>
  <div id="status-line" class="term-line">STATUS: LAUNCH_WINDOW_PENDING</div>
  <div id="countdown-timer">00:00:00</div>
  <div class="term-line" style="color: #ffd700; margin-top: 10px;">> è·¨å¹´é€šè¨Šä»»å‹™ï¼šç­‰å¾…è¡›æ˜Ÿçª—å£é–‹å•Ÿ</div>
  <button id="start-btn" disabled>æ¥æ”¶é©šå–œç¥ç¦</button>
</div>

<!-- çµæŸä»‹é¢ -->
<div id="end-screen">
  <div class="term-line" style="font-size: 20px; color: #ffd700;">MISSION COMPLETE</div>
  <div class="term-line" style="margin-top: 20px;">é ç«¯é€£ç·šå·²ä¸­æ–·...</div>
  <div class="term-line" style="color: #666;">é©šå–œå·²çµæŸ</div>
</div>

<!-- æˆ°è¡“ HUD -->
<div id="hud">
  <div class="reticle tl"></div><div class="reticle tr"></div>
  <div class="reticle bl"></div><div class="reticle br"></div>
  <div id="data-stream">
    SIGNAL: STABLE<br>
    UNIT: DRONE_SQUAD_2026<br>
    CMD: LONG_PRESS_TO_CHARGE<br>
    DBL_TAP: SKIP_PATTERN
  </div>
  <div id="charge-ui"><div id="charge-bar"></div></div>
</div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const tCanvas = document.createElement("canvas");
const tCtx = tCanvas.getContext("2d");
tCanvas.width = 2000; tCanvas.height = 1000;

// --- é«˜è§£æåº¦æ–‡å­— canvas ---
const scaleFactor = 2;  // æ”¾å¤§ 2 å€
tCanvas.width = 2000 * scaleFactor;
tCanvas.height = 1000 * scaleFactor;
tCtx.setTransform(1,0,0,1,0,0);  // æ¸…é™¤ä»»ä½•èˆŠç¸®æ”¾
tCtx.scale(scaleFactor, scaleFactor);
  
let width, height, drones = [], fireworks = [], fwParticles = [];
let isStarted = false, isEnded = false, currentIdx = 0;
let mouse = { x: -1000, y: -1000, active: false, charge: 0 };
let lastTap = 0;


// é«˜è§£æåº¦åˆå§‹åŒ–
function resizeCanvas() {
  scale = window.devicePixelRatio || 1;
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width * scale;
  canvas.height = height * scale;
  canvas.style.width = width + "px";
  canvas.style.height = height + "px";
  ctx.setTransform(1,0,0,1,0,0);
  ctx.scale(scale, scale);
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// è¨­å®šç›®æ¨™æ™‚é–“ï¼š2026å¹´1æœˆ1æ—¥ 00:00:00
const targetTime = new Date("2026/01/01 00:00:00").getTime();

const patterns = [
  { text: "å®£è¾°å°‘çˆº", color: "#FFD700" },
  { text: "READY?", color: "#00FF95" },
  { text: "3", color: "#00FF95" },
  { text: "2", color: "#00FF95" },
  { text: "1", color: "#00FF95" },
  { text: "2026\nHAPPY NEW YEAR", color: "#00E5FF" },
  { text: "é€€ä¼å€’æ•¸", color: "#FFA500" },
  { text: "å…‰æ¦®æ­¸ä¾†", color: "#FF6EB4" },
  { text: "ğŸ–ï¸", color: "#FFD700" }
];

// --- å€’æ•¸è¨ˆæ™‚é‚è¼¯ ---
function updateCountdown() {
    const now = new Date().getTime();
    const diff = targetTime - now;

    if (diff <= 0) {
        document.getElementById("countdown-timer").innerText = "00:00:00";
        document.getElementById("countdown-timer").style.color = "#00ff41";
        document.getElementById("countdown-timer").style.textShadow = "0 0 10px #00ff41";
        document.getElementById("status-line").innerText = "STATUS: ACCESS_GRANTED";
        const btn = document.getElementById("start-btn");
        btn.disabled = false;
        btn.classList.add("unlocked");
        return;
    }

    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((diff % (1000 * 60)) / 1000);

    document.getElementById("countdown-timer").innerText = 
        `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    
    requestAnimationFrame(updateCountdown);
}
updateCountdown();

function init() {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
  if (drones.length === 0) {
    for (let i = 0; i < 2800; i++) drones.push(new Drone());
  }
}

class Drone {
  constructor() {
    this.x = Math.random() * window.innerWidth;
    this.y = Math.random() * window.innerHeight;
    this.targetX = this.x; this.targetY = this.y;
    this.vx = 0; this.vy = 0;
    this.color = '#fff';
    this.size = 1.6;
    this.easing = 0.05 + Math.random() * 0.03;
    this.noise = Math.random() * 100;
  }
  update() {
    let dx = this.targetX - this.x;
    let dy = this.targetY - this.y;
    this.vx += dx * 0.01;
    this.vy += dy * 0.01;

    if (mouse.active && !isEnded) {
      let mdx = mouse.x - this.x;
      let mdy = mouse.y - this.y;
      let dist = Math.sqrt(mdx*mdx + mdy*mdy);
      if (mouse.charge > 5) {
        this.vx += mdx * 0.04; this.vy += mdy * 0.04;
      } else if (dist < 100) {
        this.vx -= mdx * 0.2; this.vy -= mdy * 0.2;
      }
    }
    this.vx *= 0.85; this.vy *= 0.85;
    this.x += this.vx; this.y += this.vy;
    this.x += Math.sin(Date.now() * 0.002 + this.noise) * 0.2;
    this.y += Math.cos(Date.now() * 0.002 + this.noise) * 0.2;
  }
  draw() {
    ctx.fillStyle = this.color;
    ctx.shadowBlur = 5;
    ctx.shadowColor = this.color;
    ctx.fillRect(this.x, this.y, this.size, this.size);
    ctx.shadowBlur = 0;
  }
}

function loadPattern(obj) {
  tCtx.clearRect(0, 0, tCanvas.width, tCanvas.height);
  const lines = obj.text.split('\n');
  let fontSize = (obj.text.length > 4) ? 180 : 250;
  if (obj.text.length > 12) fontSize = 130;

  tCtx.font = `900 ${fontSize}px "Microsoft JhengHei", "PingFang TC", sans-serif`;
  tCtx.textAlign = "left"; tCtx.textBaseline = "top"; 
  tCtx.fillStyle = "white";

  const lineHeight = fontSize * 1.2;
  lines.forEach((line, index) => {
    tCtx.fillText(line, 50, 50 + (index * lineHeight));
  });

  const imgData = tCtx.getImageData(0, 0, tCanvas.width, tCanvas.height).data;
  const pixels = [];
  let minX = 9999, maxX = 0, minY = 9999, maxY = 0;

  const gap = 10;
  for (let y = 0; y < tCanvas.height; y += gap) {
    for (let x = 0; x < tCanvas.width; x += gap) {
      if (imgData[(y * tCanvas.width + x) * 4 + 3] > 128) {
        pixels.push({ x: x / scaleFactor, y: y / scaleFactor }); // é™¤ä»¥ scaleFactor
        if (x < minX) minX = x; if (x > maxX) maxX = x;
        if (y < minY) minY = y; if (y > maxY) maxY = y;
      }
    }
  }

  const textCenterX = (minX + maxX) / 2 / scaleFactor;
  const textCenterY = (minY + maxY) / 2 / scaleFactor;
  const textWidth = (maxX - minX) / scaleFactor;
  const textHeight = (maxY - minY) / scaleFactor;
  const scale = Math.min((width * 0.8) / textWidth, (height * 0.45) / textHeight, 1.5);

  drones.forEach((d, i) => {
    const p = pixels[i % pixels.length];
    d.targetX = (p.x - textCenterX) * scale + (width / 2);
    d.targetY = (p.y - textCenterY) * scale + (height / 2);
    d.color = obj.color;
    d.vx += (Math.random()-0.5)*20; d.vy += (Math.random()-0.5)*20;
  });
}

function endShow() {
    isEnded = true;
    drones.forEach(d => {
        d.targetX = Math.random() * width;
        d.targetY = Math.random() * height;
        d.color = "rgba(255,255,255,0.2)";
    });
    const endScreen = document.getElementById("end-screen");
    endScreen.style.display = "flex";
    setTimeout(() => {
        endScreen.style.opacity = "1";
        document.getElementById("hud").style.opacity = "0";
    }, 100);
}

function nextStep() {
    if (isEnded) return;
    currentIdx++;
    if (currentIdx < patterns.length) {
        loadPattern(patterns[currentIdx]);
        let waitTime = 5000;
        const currentText = patterns[currentIdx].text;
        if (["READY?", "3", "2", "1"].includes(currentText)) waitTime = 1500;
        else if (currentText.includes("HAPPY")) waitTime = 7000;
        setTimeout(nextStep, waitTime);
    } else {
        setTimeout(endShow, 5000);
    }
}

class Firework {
  constructor(tx, ty, hue) {
    this.x = tx || Math.random() * width;
    this.y = height;
    this.ty = ty || Math.random() * (height * 0.4);
    this.speed = 7 + Math.random() * 4;
    this.hue = hue || Math.random() * 360;
    this.dead = false;
  }
  update() {
    this.y -= this.speed;
    if (this.y <= this.ty) {
      this.dead = true;
      for(let i=0; i<40; i++) fwParticles.push(new FWParticle(this.x, this.y, this.hue));
    }
  }
  draw() {
    ctx.fillStyle = `hsl(${this.hue}, 100%, 70%)`;
    ctx.fillRect(this.x, this.y, 2, 10);
  }
}

class FWParticle {
  constructor(x, y, hue) {
    this.x = x; this.y = y; this.hue = hue;
    this.v = { x: (Math.random()-0.5)*10, y: (Math.random()-0.5)*10 };
    this.alpha = 1; this.decay = 0.02;
  }
  update() { this.x += this.v.x; this.y += this.v.y; this.v.y += 0.1; this.alpha -= this.decay; }
  draw() {
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = `hsl(${this.hue}, 100%, 70%)`;
    ctx.beginPath(); ctx.arc(this.x, this.y, 1.2, 0, Math.PI*2); ctx.fill();
    ctx.globalAlpha = 1;
  }
}

function animate() {
  ctx.globalCompositeOperation = 'source-over';
  ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
  ctx.fillRect(0, 0, width, height);

  if (isStarted) {
    if (mouse.active && !isEnded) {
      mouse.charge = Math.min(mouse.charge + 1.5, 100);
      document.getElementById("charge-bar").style.width = mouse.charge + "%";
      document.getElementById("charge-ui").style.display = "block";
    }
    ctx.globalCompositeOperation = 'lighter';
    if (Math.random() < 0.03 && !isEnded) fireworks.push(new Firework());
    fireworks = fireworks.filter(f => !f.dead);
    fireworks.forEach(f => { f.update(); f.draw(); });
    fwParticles = fwParticles.filter(p => p.alpha > 0);
    fwParticles.forEach(p => { p.update(); p.draw(); });
    ctx.globalCompositeOperation = 'source-over';
    drones.forEach(d => { d.update(); d.draw(); });
  }
  requestAnimationFrame(animate);
}

document.getElementById("start-btn").addEventListener("click", function() {
  if (this.disabled) return;
  document.getElementById("boot-screen").style.opacity = "0";
  setTimeout(() => {
    document.getElementById("boot-screen").style.display = "none";
    document.getElementById("hud").style.display = "block";
    isStarted = true;
    init(); 
    loadPattern(patterns[currentIdx]); 
    animate();
    setTimeout(nextStep, 5000);
  }, 800);
});

const handleDown = (e) => {
  if (!isStarted || isEnded) return;
  const now = Date.now();
  if (now - lastTap < 300) {
    currentIdx++;
    if (currentIdx < patterns.length) loadPattern(patterns[currentIdx]);
    else endShow();
    return;
  }
  lastTap = now;
  const p = e.touches ? e.touches[0] : e;
  mouse.x = p.clientX; mouse.y = p.clientY;
  mouse.active = true;
};

const handleUp = () => {
  if (mouse.charge > 50) {
    for(let i=0; i<6; i++) {
      setTimeout(() => fireworks.push(new Firework(Math.random()*width, Math.random()*height*0.5)), i * 120);
    }
  }
  mouse.active = false;
  mouse.charge = 0;
  document.getElementById("charge-ui").style.display = "none";
};

const handleMove = (e) => {
  const p = e.touches ? e.touches[0] : e;
  mouse.x = p.clientX; mouse.y = p.clientY;
};

window.addEventListener("mousedown", handleDown);
window.addEventListener("mouseup", handleUp);
window.addEventListener("mousemove", handleMove);
window.addEventListener("touchstart", handleDown);
window.addEventListener("touchend", handleUp);
window.addEventListener("touchmove", handleMove);

window.addEventListener("resize", () => {
  width = canvas.width = window.innerWidth;
  height = canvas.height = window.innerHeight;
});
</script>
</body>

</html>




